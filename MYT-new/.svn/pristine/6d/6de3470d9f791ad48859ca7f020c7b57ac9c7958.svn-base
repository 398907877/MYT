package com.yihu.myt.service.service.impl;import java.util.List;import com.coreframework.db.DB;import com.coreframework.db.JdbcConnection;import com.coreframework.db.Sql;import com.yihu.myt.dao.ConsWaterQualityDAO;import com.yihu.myt.enums.MyDatabaseEnum;import com.yihu.myt.enums.ConsWaterQualitySqlNameEnum;import com.yihu.myt.util.StringUtil;import com.yihu.myt.vo.ConsWaterQualityVo;import com.yihu.myt.service.service.IConsWaterQualityService;
public class ConsWaterQualityService implements IConsWaterQualityService{
ConsWaterQualityDAO consWaterQualityDAO = new ConsWaterQualityDAO();
	/**	*获取列表记录数	*/	public Integer queryConsWaterQualityCountByCondition(ConsWaterQualityVo vo) throws Exception{		Sql sql = DB.me().createSql(ConsWaterQualitySqlNameEnum.queryConsWaterQualityCountByCondition);		StringBuilder condition = new StringBuilder();		sql.addVar("@condition", condition.toString());		Integer count = DB.me().queryForInteger(MyDatabaseEnum.boss, sql);		return count;	}
	/**	*获取列表	*/	public List<ConsWaterQualityVo> queryConsWaterQualityListByCondition(ConsWaterQualityVo vo) throws Exception{		Sql sql = DB.me().createSql(ConsWaterQualitySqlNameEnum.queryConsWaterQualityListByCondition);		StringBuilder condition = new StringBuilder();				if(vo.getQualityID()!=null){			condition.append(" and QualityID =" + vo.getQualityID());		}		if(vo.getcWaterID()!=null){			condition.append(" and cWaterID =" + vo.getcWaterID());		}		sql.addVar("@condition", condition.toString());		sql.addVar("@page", "");		List<ConsWaterQualityVo> list = DB.me().queryForBeanList(MyDatabaseEnum.boss, sql,ConsWaterQualityVo.class);		return list;	}	public ConsWaterQualityVo  queryConsWaterQuality(ConsWaterQualityVo vo) throws Exception{		List<ConsWaterQualityVo> list = this.queryConsWaterQualityListByCondition(vo);		if (list == null || list.size() == 0) {			return null;		} else {			return list.get(0);		}	}
	/**	*添加	*/	public void insertConsWaterQuality(ConsWaterQualityVo vo) throws Exception{		JdbcConnection conn = DB.me().getConnection(MyDatabaseEnum.boss);		try {		conn.beginTransaction();		consWaterQualityDAO.insertConsWaterQuality(vo,conn);		conn.commitTransaction(true);		} catch (Exception e) {		conn.rollbackAndclose();		throw e;}}			/**	*添加	*/	public void updateConsWaterQuality(ConsWaterQualityVo vo) throws Exception{		JdbcConnection conn = DB.me().getConnection(MyDatabaseEnum.boss);		try {		conn.beginTransaction();		consWaterQualityDAO.updateConsWaterQualityByCondition(vo,conn);		conn.commitTransaction(true);		} catch (Exception e) {		conn.rollbackAndclose();		throw e;}}		}
package com.yihu.myt.service.service.impl;import java.util.List;import com.coreframework.db.DB;import com.coreframework.db.JdbcConnection;import com.coreframework.db.Sql;import com.yihu.myt.dao.DepAndDisDAO;import com.yihu.myt.enums.DepAndDisSqlNameEnum;import com.yihu.myt.enums.MyDatabaseEnum;import com.yihu.myt.service.service.IDepAndDisService;import com.yihu.myt.vo.DepAndDisVo;
public class DepAndDisService implements IDepAndDisService{
DepAndDisDAO depAndDisDAO = new DepAndDisDAO();
	/**	*获取列表记录数	*/	public Integer queryDepAndDisCountByCondition(DepAndDisVo vo) throws Exception{		Sql sql = DB.me().createSql(DepAndDisSqlNameEnum.queryDepAndDisCountByCondition);		StringBuilder condition = new StringBuilder();		sql.addVar("@condition", condition.toString());		Integer count = DB.me().queryForInteger(MyDatabaseEnum.boss, sql);		return count;	}
	/**	*获取列表	*/	public List<DepAndDisVo> queryDepAndDisListByCondition(DepAndDisVo vo) throws Exception{		Sql sql = DB.me().createSql(DepAndDisSqlNameEnum.queryDepAndDisListByCondition);		StringBuilder condition = new StringBuilder();		sql.addVar("@condition", condition.toString());		sql.addVar("@page", "");		List<DepAndDisVo> list = DB.me().queryForBeanList(MyDatabaseEnum.boss, sql,DepAndDisVo.class);		return list;	}
	/**	*添加	*/	public void insertDepAndDis(DepAndDisVo vo) throws Exception{		JdbcConnection conn = DB.me().getConnection(MyDatabaseEnum.YiHuNet2008);		try {		conn.beginTransaction();		depAndDisDAO.insertDepAndDis(vo,conn);		conn.commitTransaction(true);		} catch (Exception e) {		conn.rollbackAndclose();		throw e;}}			/**	*添加	*/	public void updateDepAndDis(DepAndDisVo vo) throws Exception{		JdbcConnection conn = DB.me().getConnection(MyDatabaseEnum.boss);		try {		conn.beginTransaction();		depAndDisDAO.insertDepAndDis(vo,conn);		conn.commitTransaction(true);		} catch (Exception e) {		conn.rollbackAndclose();		throw e;}}		}
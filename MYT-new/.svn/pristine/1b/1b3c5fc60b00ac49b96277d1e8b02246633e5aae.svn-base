package com.yihu.myt.service.service.impl;import java.util.List;import com.coreframework.db.DB;import com.coreframework.db.JdbcConnection;import com.coreframework.db.Sql;import com.yihu.myt.dao.ConsWaterFollowDAO;import com.yihu.myt.enums.MyDatabaseEnum;import com.yihu.myt.enums.ConsWaterFollowSqlNameEnum;import com.yihu.myt.util.StringUtil;import com.yihu.myt.vo.ConsWaterFollowVo;import com.yihu.myt.service.service.IConsWaterFollowService;
public class ConsWaterFollowService implements IConsWaterFollowService{
ConsWaterFollowDAO consWaterFollowDAO = new ConsWaterFollowDAO();
	/**	*获取列表记录数	*/	public Integer queryConsWaterFollowCountByCondition(ConsWaterFollowVo vo) throws Exception{		Sql sql = DB.me().createSql(ConsWaterFollowSqlNameEnum.queryConsWaterFollowCountByCondition);		StringBuilder condition = new StringBuilder();		if(vo.getWaterFollowID()!=null){			condition.append(" and WaterFollowID =" + vo.getWaterFollowID());		}		if(vo.getConsWaterID()!=null){			condition.append(" and ConsWaterID =" + vo.getConsWaterID());		}		sql.addVar("@condition", condition.toString());		Integer count = DB.me().queryForInteger(MyDatabaseEnum.boss, sql);		return count;	}
	/**	*获取列表	*/	public List<ConsWaterFollowVo> queryConsWaterFollowListByCondition(ConsWaterFollowVo vo) throws Exception{		Sql sql = DB.me().createSql(ConsWaterFollowSqlNameEnum.queryConsWaterFollowListByCondition);		StringBuilder condition = new StringBuilder();		if(vo.getWaterFollowID()!=null){			condition.append(" and WaterFollowID =" + vo.getWaterFollowID());		}		if(vo.getConsWaterID()!=null){			condition.append(" and ConsWaterID =" + vo.getConsWaterID());		}		sql.addVar("@condition", condition.toString());		sql.addVar("@page", "");		List<ConsWaterFollowVo> list = DB.me().queryForBeanList(MyDatabaseEnum.boss, sql,ConsWaterFollowVo.class);		return list;	}	public ConsWaterFollowVo queryConsWaterFollow(ConsWaterFollowVo vo ) throws Exception {		List<ConsWaterFollowVo>  list = this.queryConsWaterFollowListByCondition(vo);		if (list == null || list.size() == 0) {			return null;		} else {			return list.get(0);		}	}
	/**	*添加	*/	public void insertConsWaterFollow(ConsWaterFollowVo vo) throws Exception{		JdbcConnection conn = DB.me().getConnection(MyDatabaseEnum.boss);		try {		conn.beginTransaction();		consWaterFollowDAO.insertConsWaterFollow(vo,conn);		conn.commitTransaction(true);		} catch (Exception e) {		conn.rollbackAndclose();		throw e;}}			/**	*添加	*/	public void updateConsWaterFollow(ConsWaterFollowVo vo) throws Exception{		JdbcConnection conn = DB.me().getConnection(MyDatabaseEnum.boss);		try {		conn.beginTransaction();		consWaterFollowDAO.updateConsWaterFollowByCondition(vo,conn);		conn.commitTransaction(true);		} catch (Exception e) {		conn.rollbackAndclose();		throw e;}}		}